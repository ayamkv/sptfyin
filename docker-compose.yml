# PocketBase Docker Compose Configuration
#
# This file is tracked in git. Secrets should be stored in .env file (not tracked).
# On VPS: Create .env file with CF_SECRET_KEY=your_actual_secret
#
# Usage:
#   docker compose up -d        # Start container
#   docker compose restart      # Restart after updates
#   docker compose logs -f      # View logs

services:
  pocketbase:
    image: ghcr.io/muchobien/pocketbase:latest
    tty: true
    container_name: pocketbase
    restart: unless-stopped
    ports:
      - '8091:8090'
    volumes:
      - ./pb_data:/pb_data
      - ./pb_public:/pb_public
      - ./pocketbase/pb_hooks:/pb_hooks
      - ./pocketbase/pb_migrations:/pb_migrations
      - '/etc/localtime:/etc/localtime:ro'
      - '/etc/timezone:/etc/timezone:ro'
    healthcheck:
      test: wget --no-verbose --tries=1 --spider http://localhost:8090/api/health || exit 1
      interval: 60s
      timeout: 10s
      retries: 2
    environment:
      TZ: 'Asia/Jakarta'
      CF_SECRET_KEY: '${CF_SECRET_KEY}'
